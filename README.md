# üß© Microservices User Notification System

> NestJS-based microservices system for user management and delayed push notifications

## üìö –û–ø–∏—Å

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î —Å–∏—Å—Ç–µ–º—É –∑ —Ç—Ä—å–æ–º–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∞–º–∏ –¥–ª—è:
- –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏,
- –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ push-—Å–ø–æ–≤—ñ—â–µ–Ω—å —á–µ—Ä–µ–∑ 24 –≥–æ–¥–∏–Ω–∏ –ø—ñ—Å–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó,
- –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, webhook).

–ö–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å —î –æ–∫—Ä–µ–º–∏–º NestJS-–¥–æ–¥–∞—Ç–∫–æ–º, —ñ–∑–æ–ª—å–æ–≤–∞–Ω–∏–º —ñ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏–º.

---

## üîß –ú—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏

### 1. `service-core`

- –û–±—Ä–æ–±–ª—è—î HTTP-–∑–∞–ø–∏—Ç `POST /api/users` –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –ó–±–µ—Ä—ñ–≥–∞—î —ñ–º‚Äô—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —É PostgreSQL.
- –ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–¥—ñ—é —á–µ—Ä–µ–∑ RabbitMQ –¥–æ —ñ–Ω—à–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤.

### 2. `service-notification`

- –°–ª—É—Ö–∞—î –ø–æ–¥—ñ—ó –ø—Ä–æ –Ω–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.
- –ß–µ—Ä–µ–∑ 24 –≥–æ–¥–∏–Ω–∏ (—ñ–º—ñ—Ç–∞—Ü—ñ—è —á–µ—Ä–µ–∑ cron –∞–±–æ Redis, –Ω–∞—Ä–∞–∑—ñ BullMQ –ø–æ–≤–µ—Ä—Ö redis) –Ω–∞–¥—Å–∏–ª–∞—î push-—Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è.
- –ü—É–±–ª—ñ–∫—É—î –ø–æ–¥—ñ—é –¥–ª—è `service-integration`.

### 3. `service-integration`

- –°–ª—É—Ö–∞—î –ø–æ–¥—ñ—ó –ø—Ä–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è push.
- –ù–∞–¥—Å–∏–ª–∞—î HTTP-–∑–∞–ø–∏—Ç –Ω–∞ [webhook.site](https://webhook.site/) ‚Äî –¥–ª—è –µ–º—É–ª—è—Ü—ñ—ó push-–Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **NestJS** ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω–∞ –ª–æ–≥—ñ–∫–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤
- **RabbitMQ** ‚Äî –±—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏
- **PostgreSQL** ‚Äî –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **Redis** (–æ–ø—Ü—ñ–π–Ω–æ) ‚Äî —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–∞—Ç—Ä–∏–º–∫–∏/—Ç–∞–π–º–µ—Ä—ñ–≤
- **Docker / Docker Compose** ‚Äî —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞ –∑–∞–ø—É—Å–∫ —É—Å—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤
- **Webhook.site** ‚Äî —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è "–Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è push"

---

## Start working
### Running common containers
*turn on docker desktop 
```bash
# This command starts containers with Postgres, RabbitMQ, and Redis
$ docker compose -f docker-compose.common.yml up -d
```

### Running apps
```bash
# Development build with watch mode
$ docker compose -f docker-compose.dev.yml up --build

# Production build
$ docker compose up --build

# Run service without docker
## This may require changes to the .env files
$ yarn start:dev [service name]
```

## –Ø–∫ –∑–∞—Ä–∞–∑ —É—Å–µ –ø—Ä–∞—Ü—é—î —Ä–∞–∑–æ–º:
- service-core –ø—É–±–ª—ñ–∫—É—î –ø–æ–¥—ñ—é RabbitMQ: { cmd: 'push-user-by-name' }.
- user-created.listener.ts —Å–ª—É—Ö–∞—î —Ü—é –ø–æ–¥—ñ—é —á–µ—Ä–µ–∑ @MessagePattern(...).
- listener –≤–∏–∫–ª–∏–∫–∞—î –º–µ—Ç–æ–¥ schedulePush(...) —ñ–∑ NotificationService.
- NotificationService –¥–æ–¥–∞—î –∑–∞–¥–∞—á—É –¥–æ BullMQ —á–µ—Ä–≥–∏ push-user, –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é 24 –≥–æ–¥–∏–Ω–∏.
- –ß–µ—Ä–µ–∑ 24 –≥–æ–¥–∏–Ω–∏ NotificationProcessor —Å–ª—É—Ö–∞—î —Ü—é –∑–∞–¥–∞—á—É –π –≤–∏–∫–æ–Ω—É—î (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç –¥–æ service-integration –∞–±–æ –ø—É—à–∏—Ç—å –Ω–∞–ø—Ä—è–º—É).

## service-notification –º–æ–¥—É–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- **notification**	–ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
- **notification-queue**	–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è BullMQ + Redis, —Ç–æ–±—Ç–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—è —á–µ—Ä–≥–∞/–±—É–¥–∏–ª—å–Ω–∏–∫
- **events** –°–ª—É—Ö–∞–Ω–Ω—è –ø–æ–¥—ñ–π RMQ —ñ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤
- **rmq** (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–ø—ñ–ª—å–Ω–∏–π –º–æ–¥—É–ª—å –∑ libs) –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è RabbitMQ